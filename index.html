<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeCoding 2 - Procedural Music Generator</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <!-- Tone.js for audio playback and synthesis -->
    <script src="https://cdn.jsdelivr.net/npm/tone@14.8.49/build/Tone.js"></script>
    <!-- Tonal.js for music theory -->
    <script src="https://cdn.jsdelivr.net/npm/tonal/browser/tonal.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>VibeCoding 2</h1>
            <p class="subtitle">Procedural music generation experiments</p>
        </header>

        <!-- Tab Navigation -->
        <nav class="tab-navigation">
            <button class="tab-button active" data-tab="procedural">Procedural</button>
            <button class="tab-button" data-tab="guided">Guided</button>
        </nav>

        <main>
            <!-- Procedural Tab Content -->
            <div id="proceduralTab" class="tab-content active">
            <!-- Master Controls -->
            <section class="master-controls">
                <button id="playPause" class="main-button">Start</button>

                <div class="control-group">
                    <label for="keySelect">Key/Scale:</label>
                    <select id="keySelect">
                        <option value="C major">C Major</option>
                        <option value="D major">D Major</option>
                        <option value="E major">E Major</option>
                        <option value="G major">G Major</option>
                        <option value="A minor" selected>A Minor</option>
                        <option value="C minor">C Minor</option>
                        <option value="E minor">E Minor</option>
                        <option value="D minor">D Minor</option>
                        <option value="C lydian">C Lydian</option>
                        <option value="D lydian">D Lydian</option>
                        <option value="A lydian">A Lydian</option>
                        <option value="C dorian">C Dorian</option>
                        <option value="D dorian">D Dorian</option>
                        <option value="A dorian">A Dorian</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="styleSelect">Style:</label>
                    <select id="styleSelect">
                        <option value="synthwave" selected>Synthwave</option>
                        <option value="techno">Techno</option>
                        <option value="trance">Trance</option>
                        <option value="house">House</option>
                        <option value="ambient">Ambient</option>
                        <option value="random">Random</option>
                    </select>
                    <button id="regenerateBtn" class="pattern-btn">Regenerate</button>
                </div>

                <div class="control-group">
                    <label>
                        <input type="checkbox" id="useMarkov">
                        Use Markov Chain (AI-learned progressions)
                    </label>
                </div>

                <div class="control-group">
                    <label for="bpmSlider">Tempo (BPM)</label>
                    <input type="range" id="bpmSlider" min="70" max="130" step="1" value="90">
                    <span id="bpmValue">90</span>
                </div>

                <div class="control-group">
                    <label for="masterVolume">Master Volume</label>
                    <input type="range" id="masterVolume" min="0" max="1" step="0.01" value="0.7">
                    <span id="masterVolumeValue">70%</span>
                </div>
            </section>

            <!-- Stem Controls -->
            <section class="stems">
                <div class="stem-card">
                    <h3>Drums</h3>
                    <div class="stem-controls">
                        <input type="range" class="stem-volume" id="drumsVolume" min="0" max="1" step="0.01" value="0.5">
                        <span class="volume-value">50%</span>
                        <button class="toggle-stem active" data-stem="drums">Active</button>
                        <button id="drumPatternBtn" class="pattern-btn">4-on-Floor</button>
                    </div>
                    <div class="stem-controls">
                        <label for="drumPitch">Pitch</label>
                        <input type="range" id="drumPitch" min="-12" max="12" step="1" value="0">
                        <span id="drumPitchValue">0</span>
                    </div>
                    <div class="stem-controls">
                        <label>
                            <input type="checkbox" id="useEuclidean">
                            Euclidean Rhythm
                        </label>
                    </div>
                    <div id="euclideanControls" class="euclidean-controls" style="display: none;">
                        <div class="stem-controls">
                            <label for="euclideanPulses">Pulses (beats)</label>
                            <input type="range" id="euclideanPulses" min="1" max="16" step="1" value="4">
                            <span id="euclideanPulsesValue">4</span>
                        </div>
                        <div class="stem-controls">
                            <label for="euclideanSteps">Steps (total)</label>
                            <input type="range" id="euclideanSteps" min="4" max="32" step="1" value="16">
                            <span id="euclideanStepsValue">16</span>
                        </div>
                    </div>
                    <div class="stem-indicator" data-stem="drums"></div>
                </div>

                <div class="stem-card">
                    <h3>Bass</h3>
                    <div class="stem-controls">
                        <input type="range" class="stem-volume" id="bassVolume" min="0" max="1" step="0.01" value="0.5">
                        <span class="volume-value">50%</span>
                        <button class="toggle-stem active" data-stem="bass">Active</button>
                    </div>
                    <div class="stem-controls">
                        <label for="bassWaveform">Waveform</label>
                        <select id="bassWaveform">
                            <option value="sine">Sine</option>
                            <option value="square">Square</option>
                            <option value="sawtooth" selected>Saw</option>
                            <option value="triangle">Triangle</option>
                        </select>
                    </div>
                    <div class="stem-controls">
                        <label for="bassRhythm">Rhythm</label>
                        <select id="bassRhythm">
                            <option value="whole">Whole Notes</option>
                            <option value="half">Half Notes</option>
                            <option value="quarter">Quarter Notes</option>
                            <option value="8th">8th Notes</option>
                            <option value="16th" selected>16th Notes</option>
                            <option value="32nd">32nd Notes</option>
                        </select>
                    </div>
                    <div class="adsr-controls">
                        <div class="adsr-slider">
                            <label>A</label>
                            <input type="range" id="bassAttack" min="0" max="2000" step="1" value="1">
                            <span class="adsr-value">1ms</span>
                        </div>
                        <div class="adsr-slider">
                            <label>D</label>
                            <input type="range" id="bassDecay" min="0" max="2000" step="1" value="340">
                            <span class="adsr-value">340ms</span>
                        </div>
                        <div class="adsr-slider">
                            <label>S</label>
                            <input type="range" id="bassSustain" min="0" max="100" step="1" value="1">
                            <span class="adsr-value">1%</span>
                        </div>
                        <div class="adsr-slider">
                            <label>R</label>
                            <input type="range" id="bassRelease" min="0" max="3000" step="1" value="0">
                            <span class="adsr-value">0ms</span>
                        </div>
                    </div>
                    <div class="stem-indicator" data-stem="bass"></div>
                </div>

                <div class="stem-card">
                    <h3>Pad</h3>
                    <div class="stem-controls">
                        <input type="range" class="stem-volume" id="padVolume" min="0" max="1" step="0.01" value="0.5">
                        <span class="volume-value">50%</span>
                        <button class="toggle-stem active" data-stem="pad">Active</button>
                    </div>
                    <div class="stem-indicator" data-stem="pad"></div>
                </div>

                <div class="stem-card">
                    <h3>Arp</h3>
                    <div class="stem-controls">
                        <input type="range" class="stem-volume" id="arpVolume" min="0" max="1" step="0.01" value="0.5">
                        <span class="volume-value">50%</span>
                        <button class="toggle-stem active" data-stem="arp">Active</button>
                    </div>
                    <div class="stem-indicator" data-stem="arp"></div>
                </div>
            </section>

            <!-- Info Section -->
            <section class="info">
                <p class="status" id="status">Click Start to begin procedural generation</p>
                <details>
                    <summary>How it works</summary>
                    <p>VibeCoding 2 uses <strong>Tone.js</strong> and <strong>Tonal.js</strong> to procedurally generate music. Select a key/scale, and the system will algorithmically choose notes from that scale to create evolving patterns.</p>
                    <p><strong>Phase 2 Prototype:</strong> This demonstrates the core concept of generating sounds. This currently uses a lead sample I created</p>
                    <p><strong>Bass, Pad, and Drums still use Tone.js synths as placeholders.</p>
                </details>
            </section>
            </div>

            <!-- Guided Tab Content -->
            <div id="guidedTab" class="tab-content">
                <section class="info">
                    <p>Guided generation coming soon...</p>
                    <p>This will feature pre-composed songs with optional variations.</p>
                </section>
            </div>
        </main>

        <footer>
            <p>A <a href="https://gostnode.com" target="_blank">GostNode</a> project</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
